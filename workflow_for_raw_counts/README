1. to generate your ppr.merged.bed file from IDR datasets:
If you have 3 biological replicates, you will need to merge these 3 files, generated by the BDS pipeline: 

export idr1=peak/idr/pseudo_reps/rep1/rep1-pr.IDR0.1.filt.narrowPeak.gz
export idr2=peak/idr/pseudo_reps/rep2/rep2-pr.IDR0.1.filt.narrowPeak.gz
export idr3=peak/idr/pseudo_reps/rep3/rep3-pr.IDR0.1.filt.narrowPeak.gz

zcat $idr1 $idr2 $idr3 > idr.concatenated.bed
bedtools merge -i idr.concatenated.bed > ppr.merged.bed



2. get your matrix of raw read counts that overlap with ppr.merged.bed
See the script "make_counts_matrix.EXAMEPLE.sh" for a case with 3 replicates.


3. generate a counts.metadata file
You can use the counts.metadata file in this repository as an example.

4.run the script "getDiff_multiFactor.r" to perform comparisons across the categories you specified in counts.metadata
